; helloworld.asm
; Author: Mayank Mohindra
; Linux x86_64

global	_start

section .text
	_start:	
		jmp call_shellcode
	shellcode:
		pop	rsi		; Write argument 2
		xor	rax,rax
		mov	al, 1		; Write System call number to rax
		mov	rdi,rax		; Write argument 1
		mov	rdx,rdi
		add	rdx,11		; Write argument 3
		syscall			; Syscall with write parameters and instruction number

		xor	rax,rax
		add	rax,60		; Exit System Call Number
		xor	rdi,rdi		; Exit argument 1
		syscall			; Syscall with exit parameters and instruction number
	call_shellcode:
		call shellcode
		message db "Hello World!"
